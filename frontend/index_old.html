<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>光影溯洄 - 基于GFPGAN的照片修复与故事重现</title>
    <!-- Tailwind CSS：通过 CDN 引入的 CSS 框架，用于快速构建响应式 UI --> 
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#FF6B35',
                        dark: '#1A1A2E',
                        light: '#F8F9FA',
                        neutral: '#6C757D'
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['"Playfair Display"', 'serif']
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' }
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' }
                        },
                        pulse: {
                            '0%, 100%': { opacity: '1' },
                            '50%': { opacity: '0.5' }
                        }
                    },
                    animation: {
                        fadeIn: 'fadeIn 0.6s ease-out forwards',
                        slideUp: 'slideUp 0.8s ease-out forwards',
                        pulse: 'pulse 2s infinite'
                    }
                }
            }
        }
    </script>
    
    <!-- 自定义样式 -->
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .text-shadow-lg {
                text-shadow: 0 4px 8px rgba(0,0,0,0.25);
            }
            .bg-blur {
                backdrop-filter: blur(8px);
            }
            .scrollbar-hide::-webkit-scrollbar {
                display: none;
            }
            .scrollbar-hide {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
            .transition-transform-opacity {
                transition-property: transform, opacity;
                transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
                transition-duration: 300ms;
            }
            .perspective {
                perspective: 1000px;
            }
            .preserve-3d {
                transform-style: preserve-3d;
            }
            .backface-hidden {
                backface-visibility: hidden;
            }
            .rotate-y-180 {
                transform: rotateY(180deg);
            }
        }
    </style>
</head>
<body class="bg-light font-sans text-dark antialiased">
    <!-- 导航栏 -->
    <nav id="main-nav" class="fixed w-full z-50 transition-all duration-300">
        <div class="container mx-auto px-4 py-3 flex items-center justify-between">
            <a href="#" class="flex items-center space-x-2">
                <div class="w-10 h-10 rounded-full bg-primary flex items-center justify-center">
                    <i class="fa fa-clock-o text-white text-xl"></i>
                </div>
                <span class="text-xl font-bold text-white">时光回溯</span>
            </a>
            
            <div class="hidden md:flex items-center space-x-8">
                <a href="#home" class="text-white hover:text-secondary transition-colors">首页</a>
                <a href="#features" class="text-white hover:text-secondary transition-colors">功能</a>
                <a href="#restoration" class="text-white hover:text-secondary transition-colors">照片修复</a>
                <a href="#story" class="text-white hover:text-secondary transition-colors">故事分享</a>
                <a href="#testimonials" class="text-white hover:text-secondary transition-colors">用户评价</a>
            </div>
            
            <div class="flex items-center space-x-4">
                <div id="user-info" class="hidden flex items-center space-x-4">
                    <div class="flex items-center">
                        <i class="fa fa-user-circle-o text-secondary text-xl mr-2"></i>
                        <span id="username-display" class="text-white"></span>
                    </div>
                    <button id="logout-btn" class="text-white hover:text-secondary transition-colors">
                        <i class="fa fa-sign-out"></i> 退出
                    </button>
                </div>

                <button id="theme-toggle" class="text-white hover:text-secondary transition-colors">
                    <i class="fa fa-moon-o"></i>
                </button>
                <button id="login-btn" class="bg-secondary hover:bg-secondary/90 text-white px-5 py-2 rounded-full transition-all hover:shadow-lg">
                    登录/注册
                </button>
                <button id="menu-toggle" class="md:hidden text-white hover:text-secondary transition-colors">
                    <i class="fa fa-bars text-xl"></i>
                </button>
            </div>
        </div>
        
        <!-- 移动端菜单 -->
        <div id="mobile-menu" class="md:hidden hidden bg-dark/95 bg-blur">
            <div class="container mx-auto px-4 py-3 flex flex-col space-y-4">
                <a href="#home" class="text-white hover:text-secondary transition-colors py-2">首页</a>
                <a href="#features" class="text-white hover:text-secondary transition-colors py-2">功能</a>
                <a href="#restoration" class="text-white hover:text-secondary transition-colors py-2">照片修复</a>
                <a href="#story" class="text-white hover:text-secondary transition-colors py-2">故事分享</a>
                <a href="#testimonials" class="text-white hover:text-secondary transition-colors py-2">用户评价</a>
            </div>
        </div>
    </nav>

    <!-- 首页 -->
    <section id="home" class="relative min-h-screen flex items-center justify-center overflow-hidden">
        <div class="absolute inset-0 z-0">
            <div class="absolute inset-0 bg-gradient-to-b from-dark/90 to-dark/70 z-10"></div>
            <img src="https://picsum.photos/id/1067/1920/1080" alt="老照片背景" class="w-full h-full object-cover">
        </div>
        
        <div class="container mx-auto px-4 z-20 text-center">
            <h1 class="text-[clamp(2.5rem,6vw,4.5rem)] font-bold text-white mb-6 animate-fadeIn text-shadow-lg leading-tight">
                让时光<span class="text-secondary">倒流</span>，重拾珍贵回忆
            </h1>
            <p class="text-[clamp(1rem,2vw,1.25rem)] text-white/90 max-w-3xl mx-auto mb-10 animate-slideUp animation-delay-300">
                利用先进的AI技术，我们能够修复褪色、破损的老照片，还原它们最初的光彩，并帮助你记录和分享照片背后的故事。
            </p>
            <div class="flex flex-col sm:flex-row justify-center gap-4 animate-slideUp animation-delay-600">
                <a href="#restoration" class="bg-primary hover:bg-primary/90 text-white px-8 py-4 rounded-full text-lg font-medium transition-all hover:shadow-lg transform hover:-translate-y-1">
                    开始修复照片
                </a>
                <a href="#features" class="bg-white/10 hover:bg-white/20 text-white border border-white/30 px-8 py-4 rounded-full text-lg font-medium transition-all hover:shadow-lg transform hover:-translate-y-1">
                    了解更多
                </a>
            </div>
            
            <div class="absolute bottom-10 left-1/2 transform -translate-x-1/2 animate-bounce">
                <a href="#features" class="text-white/70 hover:text-white transition-colors">
                    <i class="fa fa-angle-down text-2xl"></i>
                </a>
            </div>
        </div>
    </section>

    <!-- 功能介绍 -->
    <section id="features" class="py-20 bg-light">
        <div class="container mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold mb-4">我们的<span class="text-primary">功能</span></h2>
                <p class="text-neutral max-w-2xl mx-auto">通过先进的AI技术，我们提供两种核心功能，帮助你修复老照片并分享它们背后的故事</p>
            </div>
            
            <div class="grid md:grid-cols-2 gap-12">
                <!-- 功能一：照片修复 -->
                <div class="bg-white rounded-2xl shadow-xl overflow-hidden transform transition-all hover:shadow-2xl hover:-translate-y-2">
                    <div class="h-64 overflow-hidden">
                        <img src="https://picsum.photos/id/1059/800/600" alt="照片修复功能" class="w-full h-full object-cover transition-transform hover:scale-105 duration-700">
                    </div>
                    <div class="p-8">
                        <div class="w-14 h-14 rounded-full bg-primary/10 flex items-center justify-center mb-6">
                            <i class="fa fa-picture-o text-primary text-2xl"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4">老照片智能修复与美化</h3>
                        <p class="text-neutral mb-6">上传褪色、破损或模糊的老照片，我们将利用开源的GFPGAN模型自动分析并进行修复，还原照片的原始光彩，同时保留其历史韵味。</p>
                        <ul class="space-y-3 mb-8">
                            <li class="flex items-start">
                                <i class="fa fa-check text-primary mt-1 mr-3"></i>
                                <span>褪色还原与色彩增强</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa fa-check text-primary mt-1 mr-3"></i>
                                <span>划痕与破损自动修复</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa fa-check text-primary mt-1 mr-3"></i>
                                <span>模糊照片清晰化</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa fa-check text-primary mt-1 mr-3"></i>
                                <span>智能人脸修复与优化</span>
                            </li>
                        </ul>
                        <a href="#restoration" class="inline-flex items-center text-primary font-medium hover:text-primary/80 transition-colors">
                            体验功能 <i class="fa fa-arrow-right ml-2"></i>
                        </a>
                    </div>
                </div>
                
                <!-- 功能二：故事分享 -->
                <div class="bg-white rounded-2xl shadow-xl overflow-hidden transform transition-all hover:shadow-2xl hover:-translate-y-2">
                    <div class="h-64 overflow-hidden">
                        <img src="https://picsum.photos/id/1074/800/600" alt="故事分享功能" class="w-full h-full object-cover transition-transform hover:scale-105 duration-700">
                    </div>
                    <div class="p-8">
                        <div class="w-14 h-14 rounded-full bg-secondary/10 flex items-center justify-center mb-6">
                            <i class="fa fa-book text-secondary text-2xl"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4">故事回忆与分享</h3>
                        <p class="text-neutral mb-6">为修复后的照片添加文字描述或语音旁白，我们的AI模型链将帮助你整理故事背景，生成富有情感的回忆分享给亲友。</p>
                        <ul class="space-y-3 mb-8">
                            <li class="flex items-start">
                                <i class="fa fa-check text-secondary mt-1 mr-3"></i>
                                <span>文字描述与语音旁白</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa fa-check text-secondary mt-1 mr-3"></i>
                                <span>AI故事生成与整理</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa fa-check text-secondary mt-1 mr-3"></i>
                                <span>照片集与故事绑定</span>
                            </li>
                            <li class="flex items-start">
                                <i class="fa fa-check text-secondary mt-1 mr-3"></i>
                                <span>社交媒体分享与亲友互动</span>
                            </li>
                        </ul>
                        <a href="#story" class="inline-flex items-center text-secondary font-medium hover:text-secondary/80 transition-colors">
                            体验功能 <i class="fa fa-arrow-right ml-2"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 照片修复页面 -->
    <section id="restoration" class="py-20 bg-gradient-to-br from-dark to-primary/90 text-white relative overflow-hidden">
        <div class="absolute inset-0 z-0 opacity-10">
            <div class="absolute inset-0 bg-[radial-gradient(circle_at_center,rgba(255,255,255,0.1)_0%,transparent_70%)]"></div>
            <img src="https://picsum.photos/id/1068/1920/1080" alt="科技背景" class="w-full h-full object-cover">
        </div>
        
        <div class="container mx-auto px-4 relative z-10">
            <div class="text-center mb-16">
                <h2 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold mb-4">老照片<span class="text-secondary">智能修复</span></h2>
                <p class="text-white/80 max-w-2xl mx-auto">上传您的珍贵老照片，让我们的AI技术为它们注入新的生命</p>
            </div>
            
            <div class="grid md:grid-cols-2 gap-12 items-center">
                <!-- 左侧：上传和处理区域 -->
                <div class="bg-white/10 backdrop-blur-xl rounded-2xl p-8 shadow-xl border border-white/20">
                    <h3 class="text-2xl font-bold mb-6">上传您的老照片</h3>
                    
                    <!-- 上传区域 -->
                    <div id="upload-area" class="border-2 border-dashed border-white/30 rounded-xl p-10 text-center cursor-pointer hover:border-secondary transition-colors mb-8">
                        <i class="fa fa-cloud-upload text-4xl text-white/60 mb-4"></i>
                        <p class="text-white/70 mb-2">拖拽照片到此处或点击上传</p>
                        <p class="text-white/50 text-sm">支持 JPG, PNG, WEBP 格式，最大 10MB</p>
                        <input type="file" id="photo-upload" accept="image/*" class="hidden">
                    </div>
                    
                    <!-- 照片预览区域 -->
                    <div id="photo-preview" class="hidden mb-8">
                        <h4 class="text-lg font-medium mb-4">照片预览</h4>
                        <div class="relative rounded-xl overflow-hidden">
                            <img id="preview-image" src="" alt="预览照片" class="w-full h-auto rounded-xl">
                            <button id="remove-photo" class="absolute top-3 right-3 bg-dark/50 hover:bg-dark/70 text-white w-8 h-8 rounded-full flex items-center justify-center transition-colors">
                                <i class="fa fa-times"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- 处理选项 -->
                    <div class="mb-8">
                        <h4 class="text-lg font-medium mb-4">修复选项</h4>
                        <div class="grid grid-cols-2 gap-4">
                            <label class="flex items-center space-x-3 p-3 bg-white/5 rounded-lg cursor-pointer hover:bg-white/10 transition-colors">
                                <input type="checkbox" class="form-checkbox text-primary h-5 w-5 rounded" checked>
                                <span>褪色修复</span>
                            </label>
                            <label class="flex items-center space-x-3 p-3 bg-white/5 rounded-lg cursor-pointer hover:bg-white/10 transition-colors">
                                <input type="checkbox" class="form-checkbox text-primary h-5 w-5 rounded" checked>
                                <span>划痕去除</span>
                            </label>
                            <label class="flex items-center space-x-3 p-3 bg-white/5 rounded-lg cursor-pointer hover:bg-white/10 transition-colors">
                                <input type="checkbox" class="form-checkbox text-primary h-5 w-5 rounded" checked>
                                <span>人脸优化</span>
                            </label>
                            <label class="flex items-center space-x-3 p-3 bg-white/5 rounded-lg cursor-pointer hover:bg-white/10 transition-colors">
                                <input type="checkbox" class="form-checkbox text-primary h-5 w-5 rounded">
                                <span>色彩增强</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- 处理进度 -->
                    <div id="processing-area" class="hidden mb-8">
                        <h4 class="text-lg font-medium mb-3">正在修复照片</h4>
                        <div class="w-full bg-white/10 rounded-full h-2.5 mb-2">
                            <div id="progress-bar" class="bg-secondary h-2.5 rounded-full" style="width: 0%"></div>
                        </div>
                        <p id="progress-text" class="text-white/70 text-sm">分析照片中...</p>
                    </div>
                    
                    <!-- 操作按钮 -->
                    <div class="flex space-x-4">
                        <button id="start-restoration" class="flex-1 bg-secondary hover:bg-secondary/90 text-white font-medium py-3 px-6 rounded-lg transition-all hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed">
                            开始修复
                        </button>
                        <button id="reset-restoration" class="bg-white/10 hover:bg-white/20 text-white font-medium py-3 px-6 rounded-lg transition-all hover:shadow-lg">
                            重置
                        </button>
                    </div>
                </div>
                
                <!-- 右侧：修复结果展示 -->
                <div class="bg-white/10 backdrop-blur-xl rounded-2xl p-8 shadow-xl border border-white/20">
                    <h3 class="text-2xl font-bold mb-6">修复结果</h3>
                    
                    <!-- 对比视图 -->
                    <div id="comparison-view" class="hidden mb-8">
                        <div class="relative h-[400px] rounded-xl overflow-hidden border border-white/20">
                            <div id="comparison-slider" class="absolute inset-0">
                                <!-- 原图 -->
                                <div class="absolute inset-y-0 left-0 w-1/2 overflow-hidden">
                                    <div class="absolute inset-0">
                                        <img id="original-image" src="" alt="原始照片" class="absolute inset-0 h-full w-auto min-w-full">
                                    </div>
                                    <div class="absolute inset-y-0 right-0 w-px bg-white/50"></div>
                                </div>
                                <!-- 修复图 -->
                                <div class="absolute inset-0">
                                    <img id="restored-image" src="https://picsum.photos/id/1074/800/800" alt="修复照片" class="absolute inset-0 h-full w-full object-cover">
                                </div>
                                <!-- 滑块 -->
                                <div id="slider-handle" class="absolute inset-y-0 right-0 w-8 flex items-center justify-center cursor-ew-resize">
                                    <div class="w-1 h-12 bg-white/80 rounded-full"></div>
                                </div>
                            </div>
                            <div class="absolute bottom-4 left-4 bg-dark/50 text-white/80 text-sm px-3 py-1 rounded-full">
                                原图
                            </div>
                            <div class="absolute bottom-4 right-4 bg-dark/50 text-white/80 text-sm px-3 py-1 rounded-full">
                                修复后
                            </div>
                        </div>
                    </div>
                    
                    <!-- 初始状态提示 -->
                    <div id="empty-result" class="text-center py-16">
                        <div class="w-20 h-20 rounded-full bg-white/10 flex items-center justify-center mx-auto mb-6">
                            <i class="fa fa-magic text-3xl text-white/60"></i>
                        </div>
                        <h4 class="text-xl font-medium mb-3">修复结果将显示在这里</h4>
                        <p class="text-white/60 max-w-md mx-auto">上传照片并完成修复后，您可以在此处比较原始照片与修复后的效果，调整滑块查看对比</p>
                    </div>
                    
                    <!-- 结果操作 -->
                    <div id="result-actions" class="hidden flex space-x-4 mt-8">
                        <button id="download-restored-image" class="flex-1 bg-primary hover:bg-primary/90 text-white font-medium py-3 px-6 rounded-lg transition-all hover:shadow-lg">
                            <i class="fa fa-download mr-2"></i> 下载修复照片
                        </button>
                        <button id="add-to-story" class="bg-white/10 hover:bg-white/20 text-white font-medium py-3 px-6 rounded-lg transition-all hover:shadow-lg">
                            <i class="fa fa-book mr-2"></i> 添加到故事
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 故事分享页面 -->
    <section id="story" class="py-20 bg-light relative overflow-hidden">
        <div class="absolute inset-0 z-0 opacity-5">
            <img src="https://picsum.photos/id/1076/1920/1080" alt="温馨背景" class="w-full h-full object-cover">
        </div>
        
        <div class="container mx-auto px-4 relative z-10">
            <div class="text-center mb-16">
                <h2 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold mb-4 text-dark">照片<span class="text-secondary">故事分享</span></h2>
                <p class="text-neutral max-w-2xl mx-auto">为您的照片添加故事，让珍贵回忆永远流传</p>
            </div>
            
            <div class="grid md:grid-cols-5 gap-8">
                <!-- 左侧：照片选择 -->
                <div class="md:col-span-2">
                    <div class="bg-white rounded-2xl shadow-lg p-6 h-full">
                        <h3 class="text-xl font-bold mb-6 text-dark">我的照片</h3>
                        
                        <!-- 已修复照片列表 -->
                        <div class="space-y-4 max-h-[500px] overflow-y-auto pr-2 scrollbar-hide">
                            <!-- 示例照片项 -->
                            <div class="story-photo-item bg-light rounded-xl p-3 flex items-center cursor-pointer hover:shadow-md transition-shadow border-2 border-primary">
                                <img src="https://picsum.photos/id/1074/120/120" alt="示例照片" class="w-16 h-16 object-cover rounded-lg">
                                <div class="ml-4">
                                    <h4 class="font-medium text-dark">家庭合影</h4>
                                    <p class="text-sm text-neutral">修复于 2025-05-20</p>
                                </div>
                            </div>
                            
                            <div class="story-photo-item bg-light rounded-xl p-3 flex items-center cursor-pointer hover:shadow-md transition-shadow">
                                <img src="https://picsum.photos/id/1062/120/120" alt="示例照片" class="w-16 h-16 object-cover rounded-lg">
                                <div class="ml-4">
                                    <h4 class="font-medium text-dark">祖父肖像</h4>
                                    <p class="text-sm text-neutral">修复于 2025-05-18</p>
                                </div>
                            </div>
                            
                            <div class="story-photo-item bg-light rounded-xl p-3 flex items-center cursor-pointer hover:shadow-md transition-shadow">
                                <img src="https://picsum.photos/id/1072/120/120" alt="示例照片" class="w-16 h-16 object-cover rounded-lg">
                                <div class="ml-4">
                                    <h4 class="font-medium text-dark">老房子</h4>
                                    <p class="text-sm text-neutral">修复于 2025-05-15</p>
                                </div>
                            </div>
                            
                            <div class="story-photo-item bg-light rounded-xl p-3 flex items-center cursor-pointer hover:shadow-md transition-shadow">
                                <img src="https://picsum.photos/id/1066/120/120" alt="示例照片" class="w-16 h-16 object-cover rounded-lg">
                                <div class="ml-4">
                                    <h4 class="font-medium text-dark">童年照片</h4>
                                    <p class="text-sm text-neutral">修复于 2025-05-10</p>
                                </div>
                            </div>
                        </div>
                        
                        <button class="w-full mt-6 bg-primary/10 hover:bg-primary/20 text-primary font-medium py-3 rounded-lg transition-colors flex items-center justify-center">
                            <i class="fa fa-plus mr-2"></i> 添加更多照片
                        </button>
                    </div>
                </div>
                
                <!-- 右侧：故事编辑 -->
                <div class="md:col-span-3">
                    <div class="bg-white rounded-2xl shadow-lg p-8 h-full">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-xl font-bold text-dark">编辑故事</h3>
                            <div class="flex space-x-3">
                                <button class="text-neutral hover:text-dark transition-colors" title="保存草稿">
                                    <i class="fa fa-save"></i>
                                </button>
                                <button class="text-neutral hover:text-dark transition-colors" title="预览">
                                    <i class="fa fa-eye"></i>
                                </button>
                                <button class="text-neutral hover:text-dark transition-colors" title="分享">
                                    <i class="fa fa-share-alt"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- 当前选中照片 -->
                        <div class="bg-light rounded-xl p-4 mb-6">
                            <img src="https://picsum.photos/id/1074/800/500" alt="当前编辑照片" class="w-full h-64 object-cover rounded-lg mb-4">
                            <div class="flex justify-between items-center">
                                <h4 class="font-medium text-dark">家庭合影</h4>
                                <div class="flex space-x-2">
                                    <button class="text-neutral hover:text-primary transition-colors" title="更换照片">
                                        <i class="fa fa-exchange"></i>
                                    </button>
                                    <button class="text-neutral hover:text-primary transition-colors" title="调整照片">
                                        <i class="fa fa-sliders"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 故事编辑器 -->
                        <div class="space-y-6">
                            <div>
                                <label class="block text-sm font-medium text-neutral mb-2">故事标题</label>
                                <input type="text" class="w-full px-4 py-3 rounded-lg border border-gray-200 focus:border-primary focus:ring focus:ring-primary/20 outline-none transition-all" value="1985年的家庭聚会" placeholder="为您的照片故事添加标题">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-neutral mb-2">故事描述</label>
                                <textarea class="w-full px-4 py-3 rounded-lg border border-gray-200 focus:border-primary focus:ring focus:ring-primary/20 outline-none transition-all h-40 resize-none" placeholder="描述这张照片背后的故事...">这张照片拍摄于1985年的春节，是我们大家庭难得的一次团聚。照片中可以看到我的祖父母、父母、叔叔阿姨和兄弟姐妹。那年我只有5岁，对当时的情景记忆已经有些模糊，但听父母说，那是一个非常欢乐的时刻。

祖父穿着他最好的中山装，祖母脸上洋溢着幸福的笑容。父母站在后排，年轻而充满活力。叔叔抱着刚出生的小堂妹，阿姨们围坐在一起，手里还拿着包饺子的工具。

每当看到这张照片，我都会想起那个温暖的冬天，想起家人之间的关爱和亲情。虽然已经过去了很多年，但这些回忆永远留在我的心中。</textarea>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-neutral mb-2">添加标签（可选）</label>
                                <div class="flex flex-wrap gap-2 mb-2">
                                    <span class="inline-flex items-center bg-primary/10 text-primary text-sm px-3 py-1 rounded-full">
                                        家庭聚会
                                        <button class="ml-1 text-primary/70 hover:text-primary">
                                            <i class="fa fa-times-circle"></i>
                                        </button>
                                    </span>
                                    <span class="inline-flex items-center bg-primary/10 text-primary text-sm px-3 py-1 rounded-full">
                                        1985年
                                        <button class="ml-1 text-primary/70 hover:text-primary">
                                            <i class="fa fa-times-circle"></i>
                                        </button>
                                    </span>
                                    <span class="inline-flex items-center bg-primary/10 text-primary text-sm px-3 py-1 rounded-full">
                                        春节
                                        <button class="ml-1 text-primary/70 hover:text-primary">
                                            <i class="fa fa-times-circle"></i>
                                        </button>
                                    </span>
                                </div>
                                <input type="text" class="w-full px-4 py-3 rounded-lg border border-gray-200 focus:border-primary focus:ring focus:ring-primary/20 outline-none transition-all" placeholder="添加标签，用逗号分隔">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-neutral mb-2">AI故事生成</label>
                                <p class="text-sm text-neutral mb-3">让AI根据照片内容和您的描述，生成一段富有情感的故事</p>
                                <button id="generate-story" class="bg-secondary hover:bg-secondary/90 text-white font-medium py-3 px-6 rounded-lg transition-all hover:shadow-lg">
                                    <i class="fa fa-magic mr-2"></i> 生成故事
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 故事预览模态框 -->
            <div id="story-preview-modal" class="fixed inset-0 z-50 flex items-center justify-center hidden">
                <div class="absolute inset-0 bg-black/70 backdrop-blur-sm"></div>
                <div class="relative bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden">
                    <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                        <h3 class="text-xl font-bold text-dark">故事预览</h3>
                        <button id="close-preview" class="text-neutral hover:text-dark transition-colors">
                            <i class="fa fa-times text-xl"></i>
                        </button>
                    </div>
                    <div class="p-8 overflow-y-auto max-h-[calc(90vh-120px)]">
                        <div class="text-center mb-8">
                            <img src="https://picsum.photos/id/1074/1200/600" alt="故事照片" class="w-full h-80 object-cover rounded-xl mb-6">
                            <h2 class="text-3xl font-bold text-dark mb-2">1985年的家庭聚会</h2>
                            <p class="text-neutral">发布于 2025-05-23</p>
                        </div>
                        
                        <div class="prose max-w-none">
                            <p>在时光的长河中，有些记忆如同璀璨的星辰，永远闪耀在心灵的深处。这张拍摄于1985年春节的照片，便是这样一段珍贵的记忆。</p>
                            
                            <p>照片中，温暖的阳光洒在每一个人的脸上，映照着那发自内心的笑容。祖父穿着他最喜爱的中山装，笔挺而庄重，尽显长辈的威严与慈祥。祖母坐在中间，双手轻轻交叠，脸上洋溢着幸福的笑容，那是对家庭美满的欣慰。</p>
                            
                            <p>父母站在后排，年轻而充满活力。父亲微微扬起的嘴角，透露出对生活的满足；母亲温柔的眼神，仿佛能包容世间的一切美好。叔叔抱着刚出生的小堂妹，眼中满是宠爱，阿姨们围坐在一起，手里还拿着包饺子的工具，欢声笑语回荡在整个房间。</p>
                            
                            <p>那年我只有5岁，对当时的情景记忆已经有些模糊，但听父母说，那是一个非常欢乐的时刻。大人们忙着准备年夜饭，孩子们则在院子里追逐嬉戏，空气中弥漫着饺子的香气和节日的喜悦。</p>
                            
                            <p>每当我凝视这张照片，仿佛能穿越时空，回到那个温暖的冬天。我能感受到家人之间浓浓的关爱和亲情，能听到那爽朗的笑声和亲切的话语。这些回忆，如同陈酿的美酒，随着时间的推移，愈发醇厚和珍贵。</p>
                            
                            <p>如今，祖父和祖母已经离我们而去，但他们的笑容和教诲永远留在我们心中。这张照片不仅是一个时代的见证，更是我们家庭传承的纽带，让我们在忙碌的生活中，始终记得那份温暖和亲情。</p>
                        </div>
                        
                        <div class="mt-10 pt-6 border-t border-gray-200">
                            <h3 class="text-xl font-bold text-dark mb-4">相关照片</h3>
                            <div class="grid grid-cols-3 gap-4">
                                <img src="https://picsum.photos/id/1062/300/300" alt="相关照片" class="w-full h-40 object-cover rounded-lg">
                                <img src="https://picsum.photos/id/1072/300/300" alt="相关照片" class="w-full h-40 object-cover rounded-lg">
                                <img src="https://picsum.photos/id/1066/300/300" alt="相关照片" class="w-full h-40 object-cover rounded-lg">
                            </div>
                        </div>
                    </div>
                    <div class="p-6 border-t border-gray-200 flex justify-end space-x-4">
                        <button id="edit-story" class="bg-white border border-gray-200 text-dark hover:bg-gray-50 font-medium py-2 px-6 rounded-lg transition-colors">
                            编辑故事
                        </button>
                        <button class="bg-primary hover:bg-primary/90 text-white font-medium py-2 px-6 rounded-lg transition-all hover:shadow-lg">
                            <i class="fa fa-share-alt mr-2"></i> 分享故事
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 用户评价 -->
    <section id="testimonials" class="py-20 bg-gray-50">
        <div class="container mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold mb-4">用户<span class="text-primary">评价</span></h2>
                <p class="text-neutral max-w-2xl mx-auto">看看其他用户如何通过我们的服务重拾珍贵回忆</p>
            </div>
            
            <div class="grid md:grid-cols-3 gap-8">
                <!-- 评价卡片1 -->
                <div class="bg-white rounded-2xl shadow-lg p-8 transition-all hover:shadow-xl transform hover:-translate-y-2">
                    <div class="flex items-center mb-6">
                        <img src="https://picsum.photos/id/1027/100/100" alt="用户头像" class="w-14 h-14 rounded-full object-cover">
                        <div class="ml-4">
                            <h4 class="font-bold text-dark">李小明</h4>
                            <p class="text-sm text-neutral">上传了祖父的老照片</p>
                        </div>
                    </div>
                    <div class="mb-4">
                        <div class="flex text-yellow-400">
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                        </div>
                    </div>
                    <p class="text-neutral">"这是我祖父的照片，拍摄于1940年代。照片已经严重褪色和破损，但通过这个网站的修复功能，我竟然看到了祖父年轻时清晰而生动的面容。修复效果超出了我的预期，细节处理得非常好，仿佛时光真的倒流了。"</p>
                </div>
                
                <!-- 评价卡片2 -->
                <div class="bg-white rounded-2xl shadow-lg p-8 transition-all hover:shadow-xl transform hover:-translate-y-2">
                    <div class="flex items-center mb-6">
                        <img src="https://picsum.photos/id/1000/100/100" alt="用户头像" class="w-14 h-14 rounded-full object-cover">
                        <div class="ml-4">
                            <h4 class="font-bold text-dark">王芳</h4>
                            <p class="text-sm text-neutral">修复了结婚照</p>
                        </div>
                    </div>
                    <div class="mb-4">
                        <div class="flex text-yellow-400">
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star-half-o"></i>
                        </div>
                    </div>
                    <p class="text-neutral">"我和丈夫的结婚照已经有30年了，照片褪色严重，还有一些划痕。使用这个网站修复后，照片看起来像新拍的一样。色彩还原得非常自然，没有过度处理的痕迹。故事分享功能也很棒，我添加了我们的爱情故事，现在可以和孩子们一起分享这段回忆了。"</p>
                </div>
                
                <!-- 评价卡片3 -->
                <div class="bg-white rounded-2xl shadow-lg p-8 transition-all hover:shadow-xl transform hover:-translate-y-2">
                    <div class="flex items-center mb-6">
                        <img src="https://picsum.photos/id/1012/100/100" alt="用户头像" class="w-14 h-14 rounded-full object-cover">
                        <div class="ml-4">
                            <h4 class="font-bold text-dark">张伟</h4>
                            <p class="text-sm text-neutral">修复了家族照片集</p>
                        </div>
                    </div>
                    <div class="mb-4">
                        <div class="flex text-yellow-400">
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                            <i class="fa fa-star"></i>
                        </div>
                    </div>
                    <p class="text-neutral">"我花了一个周末的时间修复了我们家族的照片集，从曾祖父母的结婚照到我孩子的百天照。AI生成的故事非常有感染力，它不仅描述了照片中的场景，还推测了当时的背景和情感。我把这些照片和故事分享给了家族群，大家都非常感动，纷纷回忆起过去的美好时光。"</p>
                </div>
            </div>
            
            <!-- 统计数据 -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-8 mt-16">
                <div class="bg-white rounded-xl shadow-lg p-6 text-center">
                    <div class="text-4xl font-bold text-primary mb-2">100k+</div>
                    <p class="text-neutral">已修复照片</p>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6 text-center">
                    <div class="text-4xl font-bold text-primary mb-2">50k+</div>
                    <p class="text-neutral">已分享故事</p>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6 text-center">
                    <div class="text-4xl font-bold text-primary mb-2">98%</div>
                    <p class="text-neutral">用户满意度</p>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6 text-center">
                    <div class="text-4xl font-bold text-primary mb-2">24/7</div>
                    <p class="text-neutral">全天候服务</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 常见问题 -->
    <section class="py-20 bg-white">
        <div class="container mx-auto px-4">
            <div class="text-center mb-16">
                <h2 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold mb-4">常见<span class="text-primary">问题</span></h2>
                <p class="text-neutral max-w-2xl mx-auto">关于我们服务的常见问题解答</p>
            </div>
            
            <div class="max-w-3xl mx-auto">
                <div class="space-y-6">
                    <!-- FAQ项1 -->
                    <div class="bg-gray-50 rounded-xl overflow-hidden">
                        <button class="faq-toggle w-full flex justify-between items-center p-6 text-left font-medium text-dark hover:bg-gray-100 transition-colors">
                            <span>照片修复需要多长时间？</span>
                            <i class="fa fa-chevron-down text-neutral transition-transform"></i>
                        </button>
                        <div class="faq-content px-6 pb-6 hidden">
                            <p class="text-neutral">照片修复的时间取决于照片的复杂程度和当前服务器负载。一般来说，简单的修复可能只需要几秒钟，而复杂的修复可能需要1-2分钟。我们会在处理过程中显示进度条，让您了解修复的状态。</p>
                        </div>
                    </div>
                    
                    <!-- FAQ项2 -->
                    <div class="bg-gray-50 rounded-xl overflow-hidden">
                        <button class="faq-toggle w-full flex justify-between items-center p-6 text-left font-medium text-dark hover:bg-gray-100 transition-colors">
                            <span>修复后的照片分辨率会提高吗？</span>
                            <i class="fa fa-chevron-down text-neutral transition-transform"></i>
                        </button>
                        <div class="faq-content px-6 pb-6 hidden">
                            <p class="text-neutral">是的，我们的AI修复技术不仅能修复照片的损坏和褪色，还能在一定程度上提高照片的分辨率。不过，需要注意的是，AI无法恢复原始照片中不存在的细节，因此对于极低分辨率的照片，提升效果可能有限。</p>
                        </div>
                    </div>
                    
                    <!-- FAQ项3 -->
                    <div class="bg-gray-50 rounded-xl overflow-hidden">
                        <button class="faq-toggle w-full flex justify-between items-center p-6 text-left font-medium text-dark hover:bg-gray-100 transition-colors">
                            <span>我需要付费才能使用这些服务吗？</span>
                            <i class="fa fa-chevron-down text-neutral transition-transform"></i>
                        </button>
                        <div class="faq-content px-6 pb-6 hidden">
                            <p class="text-neutral">我们提供免费的基础修复服务，包括基本的褪色修复和划痕去除。对于更高级的功能，如高清增强、人脸优化和AI故事生成，我们提供了付费订阅计划。您可以先免费体验，再决定是否升级到高级版本。</p>
                        </div>
                    </div>
                    
                    <!-- FAQ项4 -->
                    <div class="bg-gray-50 rounded-xl overflow-hidden">
                        <button class="faq-toggle w-full flex justify-between items-center p-6 text-left font-medium text-dark hover:bg-gray-100 transition-colors">
                            <span>我的照片会被如何处理和存储？</span>
                            <i class="fa fa-chevron-down text-neutral transition-transform"></i>
                        </button>
                        <div class="faq-content px-6 pb-6 hidden">
                            <p class="text-neutral">我们尊重您的隐私，所有上传的照片仅用于修复处理目的。在您完成修复并下载照片后，我们会在24小时内自动删除服务器上的原始照片和处理后的版本。我们不会将您的照片用于其他任何目的，也不会与第三方共享。</p>
                        </div>
                    </div>
                    
                    <!-- FAQ项5 -->
                    <div class="bg-gray-50 rounded-xl overflow-hidden">
                        <button class="faq-toggle w-full flex justify-between items-center p-6 text-left font-medium text-dark hover:bg-gray-100 transition-colors">
                            <span>AI生成的故事有多准确？</span>
                            <i class="fa fa-chevron-down text-neutral transition-transform"></i>
                        </button>
                        <div class="faq-content px-6 pb-6 hidden">
                            <p class="text-neutral">AI生成的故事是基于照片内容和您提供的描述自动生成的，它们是为了帮助您整理和表达回忆，而不是替代真实的记忆。虽然我们的AI经过训练可以理解照片中的场景和情感，但最终的故事内容仍需要您进行审核和编辑，以确保其准确性和完整性。</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 页脚 -->
    <footer class="bg-dark text-white pt-16 pb-8">
        <div class="container mx-auto px-4">
            <div class="grid md:grid-cols-4 gap-8 mb-12">
                <div>
                    <div class="flex items-center space-x-2 mb-6">
                        <div class="w-10 h-10 rounded-full bg-primary flex items-center justify-center">
                            <i class="fa fa-clock-o text-white text-xl"></i>
                        </div>
                        <span class="text-xl font-bold">时光回溯</span>
                    </div>
                    <p class="text-white/70 mb-6">利用先进的AI技术，修复您的珍贵照片，重拾美好回忆。</p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-white/70 hover:text-white transition-colors">
                            <i class="fa fa-facebook"></i>
                        </a>
                        <a href="#" class="text-white/70 hover:text-white transition-colors">
                            <i class="fa fa-twitter"></i>
                        </a>
                        <a href="#" class="text-white/70 hover:text-white transition-colors">
                            <i class="fa fa-instagram"></i>
                        </a>
                        <a href="#" class="text-white/70 hover:text-white transition-colors">
                            <i class="fa fa-linkedin"></i>
                        </a>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-lg font-bold mb-6">功能</h4>
                    <ul class="space-y-3">
                        <li><a href="#restoration" class="text-white/70 hover:text-white transition-colors">照片修复</a></li>
                        <li><a href="#story" class="text-white/70 hover:text-white transition-colors">故事分享</a></li>
                        <li><a href="#" class="text-white/70 hover:text-white transition-colors">照片增强</a></li>
                        <li><a href="#" class="text-white/70 hover:text-white transition-colors">色彩修复</a></li>
                        <li><a href="#" class="text-white/70 hover:text-white transition-colors">破损修补</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="text-lg font-bold mb-6">公司</h4>
                    <ul class="space-y-3">
                        <li><a href="#" class="text-white/70 hover:text-white transition-colors">关于我们</a></li>
                        <li><a href="#" class="text-white/70 hover:text-white transition-colors">联系我们</a></li>
                        <li><a href="#" class="text-white/70 hover:text-white transition-colors">隐私政策</a></li>
                        <li><a href="#" class="text-white/70 hover:text-white transition-colors">服务条款</a></li>
                        <li><a href="#" class="text-white/70 hover:text-white transition-colors">帮助中心</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="text-lg font-bold mb-6">联系我们</h4>
                    <ul class="space-y-3">
                        <li class="flex items-start">
                            <i class="fa fa-map-marker text-primary mt-1 mr-3"></i>
                            <span class="text-white/70">北京市海淀区中关村科技园区</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fa fa-envelope text-primary mt-1 mr-3"></i>
                            <span class="text-white/70">contact@timetravel.com</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fa fa-phone text-primary mt-1 mr-3"></i>
                            <span class="text-white/70">+86 10 1234 5678</span>
                        </li>
                    </ul>
                    
                    <div class="mt-6">
                        <h4 class="text-lg font-bold mb-3">订阅我们</h4>
                        <div class="flex">
                            <input type="email" placeholder="您的邮箱地址" class="px-4 py-2 rounded-l-lg focus:outline-none text-dark w-full">
                            <button class="bg-primary hover:bg-primary/90 text-white px-4 py-2 rounded-r-lg transition-colors">
                                订阅
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="border-t border-white/10 pt-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <p class="text-white/50 text-sm mb-4 md:mb-0">© 2025 时光回溯. 保留所有权利.</p>
                    <div class="flex space-x-6">
                        <a href="#" class="text-white/50 hover:text-white text-sm transition-colors">隐私政策</a>
                        <a href="#" class="text-white/50 hover:text-white text-sm transition-colors">服务条款</a>
                        <a href="#" class="text-white/50 hover:text-white text-sm transition-colors">Cookie政策</a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        const loginBtn = document.getElementById('login-btn');
        loginBtn.addEventListener('click', function () {
            window.location.href = 'login-register.html';
        });

        // 导航栏滚动效果
        const nav = document.getElementById('main-nav');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
                nav.classList.add('bg-dark/90', 'backdrop-blur-md', 'shadow-lg');
            } else {
                nav.classList.remove('bg-dark/90', 'backdrop-blur-md', 'shadow-lg');
            }
        });
        
        // 移动端菜单切换
        const menuToggle = document.getElementById('menu-toggle');
        const mobileMenu = document.getElementById('mobile-menu');
        
        menuToggle.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        const usernameDisplay = document.getElementById('username-display');

        // 检查登录状态
        async function checkLogin() {
            const sessionId = localStorage.getItem('sessionId');
            if (!sessionId) {
                return;
            }

            console.log('sessionId:', sessionId);
            
            const myHeaders = new Headers();
            myHeaders.append("session", sessionId);
            // myHeaders.append("User-Agent", "Mozilla/5.0");
            // myHeaders.append("Accept", "*/*");

            const requestOptions = {
                method: 'GET',
                headers: myHeaders,
                redirect: 'follow'
            };

            try {
                const response = await fetch("http://localhost:8086/user/checkLogin", requestOptions);
                console.log('response: ' + response);
                const data = await response.text();
                console.log('data: ' + data);
                const parsedData = JSON.parse(data);
                const status = parsedData.result;

                console.log('登录状态:', status);
                
                if (status === 1) {
                    // 已登录，显示用户名
                    const username = localStorage.getItem('username');
                    const userInfo = document.getElementById('user-info');
                    usernameDisplay.textContent = username;
                    userInfo.classList.remove('hidden');
                    loginBtn.classList.add('hidden');
                
                    // // 添加登出按钮事件
                    // const logoutBtn = document.createElement('button');
                    // logoutBtn.className = 'ml-4 text-white hover:text-secondary transition-colors';
                    // logoutBtn.innerHTML = '<i class="fa fa-sign-out"></i> 退出';
                    // logoutBtn.addEventListener('click', logout);
                    // userInfo.appendChild(logoutBtn);
                } else {
                    // 未登录或会话过期，删除session和用户名
                    localStorage.removeItem('sessionId');
                    localStorage.removeItem('username');
                    console.log('Session expired or invalid');
                }
            } catch (error) {
                console.error('检查登录状态出错:', error);
                // 发生错误时清除可能存在的无效session
                localStorage.removeItem('sessionId');
                localStorage.removeItem('username');
            }
        }

        // 登出功能
        const logoutBtn = document.getElementById('logout-btn');
        logoutBtn.addEventListener('click', () => {
            localStorage.removeItem('sessionId');
            localStorage.removeItem('username');
            window.location.reload();
        });
        
        // 确保在DOM加载完成后调用checkLogin函数
        document.addEventListener('DOMContentLoaded', checkLogin);
        
        // 平滑滚动
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                
                if (targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - 80,
                        behavior: 'smooth'
                    });
                    
                    // 关闭移动端菜单
                    if (!mobileMenu.classList.contains('hidden')) {
                        mobileMenu.classList.add('hidden');
                    }
                }
            });
        });


        // const resetRestoration = document.getElementById('reset-restoration');
        const downloadRestoredImage = document.getElementById('download-restored-image');
        const addToStory = document.getElementById('add-to-story');
        // const storyList = document.getElementById('story-list');
        // const storyEditor = document.getElementById('story-editor');
        // const storyId = document.getElementById('story-id');
        // const storyTitle = document.getElementById('story-title');
        // const storyDescription = document.getElementById('story-description');
        // const storyTags = document.getElementById('story-tags');
        // const generateStory = document.getElementById('generate-story');
        // const downloadPdf = document.getElementById('download-pdf');
        
        // 照片上传功能
        const uploadArea = document.getElementById('upload-area');
        const photoUpload = document.getElementById('photo-upload');
        const photoPreview = document.getElementById('photo-preview');
        const previewImage = document.getElementById('preview-image');
        const removePhoto = document.getElementById('remove-photo');
        const startRestoration = document.getElementById('start-restoration');
        const processingArea = document.getElementById('processing-area');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const comparisonView = document.getElementById('comparison-view');
        const emptyResult = document.getElementById('empty-result');
        const resultActions = document.getElementById('result-actions');
        const originalImage = document.getElementById('original-image');
        const restoredImage = document.getElementById('restored-image');

        let uploadedFile;
        // let restoredImageUrl;
        // let storyIdValue;
        
        // 点击上传区域触发文件选择
        uploadArea.addEventListener('click', () => {
            photoUpload.click();
        });
        
        // 拖拽上传功能
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('border-secondary');
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('border-secondary');
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('border-secondary');
            
            if (e.dataTransfer.files.length) {
                handleFileUpload(e.dataTransfer.files[0]);
            }
        });
        
        // 文件选择处理
        photoUpload.addEventListener('change', () => {
            const file = photoUpload.files[0];
            if (photoUpload.files.length) {
                uploadedFile = file;
                handleFileUpload(photoUpload.files[0]);
            }
        });
        
        // 处理上传的文件
        function handleFileUpload(file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                previewImage.src = e.target.result;
                originalImage.src = e.target.result;
                photoPreview.classList.remove('hidden');
                startRestoration.disabled = false;
            }
            
            reader.readAsDataURL(file);
        }
        
        // 移除照片
        removePhoto.addEventListener('click', () => {
            photoUpload.value = '';
            photoPreview.classList.add('hidden');
            previewImage.src = '';
            originalImage.src = '';
            restoredImage.src = '';
            // processingArea.classList.add('hidden');
            // downloadRestoredImage.disabled = true;
            startRestoration.disabled = true;
        });
        
        // 开始修复
        startRestoration.addEventListener('click', async function () {
            if (uploadedFile) {
                // 显示处理区域
                // processingArea.classList.remove('hidden');
                // startRestoration.disabled = true;

                // 模拟处理进度
                let progress = 0;
                const progressSteps = [
                    '分析照片中...',
                    '识别损坏区域...',
                    '修复褪色...',
                    '修补划痕...',
                    '增强细节...',
                    '优化人脸...',
                    '最终处理...'
                ];
                
                const interval = setInterval(() => {
                    progress += Math.random() * 15;
                    if (progress > 100) {
                        progress = 100;
                        clearInterval(interval);
                        
                        // 处理完成，显示结果
                        setTimeout(() => {
                            processingArea.classList.add('hidden');
                            comparisonView.classList.remove('hidden');
                            emptyResult.classList.add('hidden');
                            resultActions.classList.remove('hidden');
                            
                            // 模拟滑块动画
                            const slider = document.getElementById('comparison-slider');
                            slider.style.width = '100%';
                            setTimeout(() => {
                                slider.style.width = '50%';
                            }, 500);
                        }, 500);
                    }
                    
                    const stepIndex = Math.min(Math.floor(progress / 15), progressSteps.length - 1);
                    progressBar.style.width = `${progress}%`;
                    progressText.textContent = progressSteps[stepIndex];
                }, 300);

                // 上传文件到临时存储并获取URL
                const formData = new FormData();
                formData.append('file', uploadedFile);
                const uploadResponse = await fetch('http://localhost:8086/uploadImage', {
                    method: 'POST',
                    body: formData
                });
                const uploadResult = await uploadResponse.json();
                console.log('Upload result:', uploadResult);
                const imageUrl = "http://chinese.redamancyxun.fun/echo/image/" + uploadResult.result;

                // todo: 使用上传的图片URL进行修复
                // 这里使用一个示例图片URL，实际应用中应替换为上传的图片URL
                // imageUrl = 'http://chinese.redamancyxun.fun/images/72759687ad1e4c0fac6b5bfc701d4964-image.png';

                originalImage.src = imageUrl;

                console.log('Image URL:', imageUrl);

                // // TODO
                // const Url = 'http://chinese.redamancyxun.fun/images/72759687ad1e4c0fac6b5bfc701d4964-image.png';

                // // 调用GFPGAN模型API
                // const replicateApiToken = 'r8_JdBwjt';
                // const apiUrl = 'https://api.replicate.com/v1/predictions';
                // const requestBody = {
                //     "version": "0fbacf7afc6c144e5be9767cff80f25aff23e52b0708f17e20f9879b2f21516c",
                //     "input": {
                //         "img": Url
                //     }
                // };
                if (localStorage.getItem('sessionId') === null) {
                    alert('请先登录');
                    return;
                }
                const response = await fetch('http://localhost:8086/photoStory/repairPhoto?photoUrl=' + imageUrl, {
                    method: 'POST',
                    headers: {
                        "session": localStorage.getItem('sessionId'),
                    },
                    // headers: {
                    //     "Authorization": `Bearer ${replicateApiToken}`,
                    //     "Content-Type": "application/json",
                    //     "Prefer": "wait"
                    // },
                    // body: JSON.stringify(requestBody)
                });
                const result = await response.json();
                console.log('Repair result:', result);
                const restoredImageUrl = result.result;
                console.log('Restored image URL:', restoredImageUrl);

                // 显示修复结果
                restoredImage.src = restoredImageUrl;
                // processingArea.classList.add('hidden');
                // downloadRestoredImage.disabled = false;
                // addToStory.disabled = false;
                // startRestoration.disabled = false;

                            // 创建照片故事
                // headers.delete("Content-Type");
                const createResponse = await fetch(`http://localhost:8086/photoStory/createPhotoStory?photoUrl=${restoredImageUrl}`, {
                    method: 'POST',
                    headers: {
                        "session": localStorage.getItem('sessionId'),
                    },
                });
                // const createResult = await createResponse.json();
                // storyIdValue = createResult.result.id;
            }
        });

        // 下载修复后照片事件
        downloadRestoredImage.addEventListener('click', function () {
            const link = document.createElement('a');
            link.href = restoredImageUrl;
            link.download = 'restored_image.jpg';
            link.click();
        });

        // // 添加到故事
        // addToStory.addEventListener('click', () => {
        //     alert('照片已添加到故事编辑器！');
        //     window.location.href = '#story';
        // });
        // 
        // // // 添加到故事事件
        // // addToStory.addEventListener('click', async function () {
        //     // const sessionId = localStorage.getItem('sessionId');
        //     // if (!sessionId) {
        //     //     alert('请先登录');
        //     //     return;
        //     // }
        //     // const headers = new Headers();
        //     // headers.append("session", sessionId);
        //     // headers.append("User-Agent", "Apifox/1.0.0 (https://apifox.com)");
        //     // headers.append("Accept", "*/*");
        //     // headers.append("Host", "localhost:8086");
        //     // headers.append("Connection", "keep-alive");

        //     // // 上传修复结果照片
        //     // const formData = new FormData();
        //     // const response = await fetch(restoredImageUrl);
        //     // const blob = await response.blob();
        //     // formData.append("file", blob, 'restored_image.jpg');
        //     // headers.append("Content-Type", "multipart/form-data; boundary=--------------------------372944115554292358116631");
        //     // const uploadResponse = await fetch("http://localhost:8086/uploadImage", {
        //     //     method: 'POST',
        //     //     headers: headers,
        //     //     body: formData
        //     // });
        //     // const uploadResult = await uploadResponse.json();
        //     // const photoUrl = `http://chinese.redamancyxun.fun/echo/image/${uploadResult.result}`;

        //     // // 创建照片故事
        //     // // headers.delete("Content-Type");
        //     // const createResponse = await fetch(`http://localhost:8086/photoStory/createPhotoStory?photoUrl=${photoUrl}`, {
        //     //     method: 'POST',
        //     //     headers: headers
        //     // });
        //     // const createResult = await createResponse.json();
        //     // storyIdValue = createResult.result.id;

        //     // // 显示故事编辑页面
        //     // storyEditor.classList.remove('hidden');
        //     // storyId.value = storyIdValue;
        // // });

        // // 查找用户的照片故事
        // async function findPhotoStoryByUserId() {
        //     const sessionId = localStorage.getItem('sessionId');
        //     if (!sessionId) {
        //         alert('请先登录');
        //         return;
        //     }
        //     const headers = new Headers();
        //     headers.append("session", sessionId);
        //     // headers.append("User-Agent", "Apifox/1.0.0 (https://apifox.com)");
        //     // headers.append("Accept", "*/*");
        //     // headers.append("Host", "localhost:8086");
        //     // headers.append("Connection", "keep-alive");
        //     const response = await fetch("http://localhost:8086/photoStory/findPhotoStoryByUserId", {
        //         method: 'GET',
        //         headers: headers
        //     });
        //     const result = await response.json();
        //     const stories = result.result;
        //     stories.forEach(story => {
        //         const storyItem = document.createElement('div');
        //         storyItem.classList.add('bg-white', 'rounded-2xl', 'shadow-xl', 'p-8', 'mb-8');
        //         storyItem.innerHTML = `
        //             <img src="${story.photoUrl}" alt="修复后照片" class="w-full h-auto rounded-xl mb-4">
        //             <h3 class="text-2xl font-bold mb-2">${story.title}</h3>
        //             <p class="text-neutral mb-4">${story.description}</p>
        //             <p class="text-neutral mb-4">标签: ${story.tags}</p>
        //             <button class="bg-secondary hover:bg-secondary/90 text-white font-medium py-3 px-6 rounded-lg transition-all hover:shadow-lg" data-id="${story.id}">编辑</button>
        //         `;
        //         storyList.appendChild(storyItem);

        //         // 编辑按钮点击事件
        //         const editButton = storyItem.querySelector('button');
        //         editButton.addEventListener('click', function () {
        //             storyEditor.classList.remove('hidden');
        //             storyId.value = story.id;
        //             storyTitle.value = story.title;
        //             storyDescription.value = story.description;
        //             storyTags.value = story.tags;
        //         });
        //     });
        // }

        // // if (checkLogin()) {
        // //     findPhotoStoryByUserId();
        // // }

        // // 生成故事事件
        // generateStory.addEventListener('click', async function () {
        //     const sessionId = localStorage.getItem('sessionId');
        //     if (!sessionId) {
        //         alert('请先登录');
        //         return;
        //     }
        //     const headers = new Headers();
        //     headers.append("session", sessionId);
        //     // headers.append("User-Agent", "Apifox/1.0.0 (https://apifox.com)");
        //     // headers.append("Accept", "*/*");
        //     // headers.append("Host", "localhost:8086");
        //     // headers.append("Connection", "keep-alive");
        //     const id = storyId.value;
        //     const title = storyTitle.value;
        //     const description = storyDescription.value;
        //     const tags = storyTags.value;
        //     const response = await fetch(`http://localhost:8086/photoStory/updatePhotoStory?id=${id}&title=${title}&description=${description}&tags=${tags}`, {
        //         method: 'POST',
        //         headers: headers
        //     });
        //     const result = await response.json();
        //     downloadPdf.disabled = false;
        // });

        // // 下载PDF事件
        // downloadPdf.addEventListener('click', function () {
        //     // 实现下载PDF的逻辑
        //     const link = document.createElement('a');
        //     link.href = 'path/to/your/story.pdf'; // 替换为实际的PDF文件路径
        //     link.download = 'story.pdf';
        //     link.click();

        //     alert('PDF已下载！');
        // });
        
        // 照片对比滑块
        const sliderHandle = document.getElementById('slider-handle');
        const comparisonSlider = document.getElementById('comparison-slider');
        
        if (sliderHandle && comparisonSlider) {
            let isDragging = false;
            
            sliderHandle.addEventListener('mousedown', () => {
                isDragging = true;
            });
            
            window.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                
                const container = comparisonSlider.parentElement;
                const containerRect = container.getBoundingClientRect();
                const position = e.clientX - containerRect.left;
                const percentage = Math.max(0, Math.min(100, (position / containerRect.width) * 100));
                
                comparisonSlider.style.width = `${percentage}%`;
            });
            
            window.addEventListener('mouseup', () => {
                isDragging = false;
            });
        }
        
        // 添加到故事
        document.getElementById('add-to-story').addEventListener('click', () => {
            alert('照片已添加到故事编辑器！');
            window.location.href = '#story';
        });
        
        // FAQ切换
        document.querySelectorAll('.faq-toggle').forEach(toggle => {
            toggle.addEventListener('click', () => {
                const content = toggle.nextElementSibling;
                const icon = toggle.querySelector('i');
                
                content.classList.toggle('hidden');
                icon.classList.toggle('rotate-180');
            });
        });
        
        // 生成故事
        document.getElementById('generate-story').addEventListener('click', () => {
            // 显示加载状态
            const button = document.getElementById('generate-story');
            button.innerHTML = '<i class="fa fa-spinner fa-spin mr-2"></i> 生成中...';
            button.disabled = true;
            
            // 模拟生成过程
            setTimeout(() => {
                // 显示预览模态框
                document.getElementById('story-preview-modal').classList.remove('hidden');
                
                // 恢复按钮状态
                button.innerHTML = '<i class="fa fa-magic mr-2"></i> 生成故事';
                button.disabled = false;
            }, 3000);
        });
        
        // 关闭预览
        document.getElementById('close-preview').addEventListener('click', () => {
            document.getElementById('story-preview-modal').classList.add('hidden');
        });
        
        // 编辑故事
        document.getElementById('edit-story').addEventListener('click', () => {
            document.getElementById('story-preview-modal').classList.add('hidden');
            window.location.href = '#story';
        });
        
        // 故事照片项点击
        document.querySelectorAll('.story-photo-item').forEach(item => {
            item.addEventListener('click', () => {
                // 移除其他选中状态
                document.querySelectorAll('.story-photo-item').forEach(i => {
                    i.classList.remove('border-primary');
                });
                
                // 添加选中状态
                item.classList.add('border-primary');
            });
        });
    </script>
</body>
</html>
    